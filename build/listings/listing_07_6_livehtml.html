<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB R2020a"><title>Untitled</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: normal; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S1 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: normal; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S2 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: normal; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S3 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: normal; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h3  class = 'S0'><span>Listing 7.6: Connectivity of a structure</span></h3><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: normal;"><span style="color: rgb(0, 0, 255);">function </span><span>main</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">global </span><span class="nonlocalVariableHighlighting">adj</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">global </span><span class="nonlocalVariableHighlighting">beams</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">% describe the structure as an adjacency list identifying for each</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">% node 'A'-'G' the notes to which it directly connects</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span class="nonlocalVariableHighlighting">adj</span><span> = [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span class="nonlocalVariableHighlighting">adj</span><span> = [</span><span class="nonlocalVariableHighlighting">adj</span><span>, struct(</span><span style="color: rgb(160, 32, 240);">'from'</span><span>, </span><span style="color: rgb(160, 32, 240);">'A'</span><span>, </span><span style="color: rgb(160, 32, 240);">'to'</span><span>, {{</span><span style="color: rgb(160, 32, 240);">'B'</span><span>, </span><span style="color: rgb(160, 32, 240);">'E'</span><span>}})];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span class="nonlocalVariableHighlighting">adj</span><span> = [</span><span class="nonlocalVariableHighlighting">adj</span><span>, struct(</span><span style="color: rgb(160, 32, 240);">'from'</span><span>, </span><span style="color: rgb(160, 32, 240);">'B'</span><span>, </span><span style="color: rgb(160, 32, 240);">'to'</span><span>, {{</span><span style="color: rgb(160, 32, 240);">'A'</span><span>, </span><span style="color: rgb(160, 32, 240);">'C'</span><span>, </span><span style="color: rgb(160, 32, 240);">'E'</span><span>, </span><span style="color: rgb(160, 32, 240);">'F'</span><span>}})];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span class="nonlocalVariableHighlighting">adj</span><span> = [</span><span class="nonlocalVariableHighlighting">adj</span><span>, struct(</span><span style="color: rgb(160, 32, 240);">'from'</span><span>, </span><span style="color: rgb(160, 32, 240);">'C'</span><span>, </span><span style="color: rgb(160, 32, 240);">'to'</span><span>, {{</span><span style="color: rgb(160, 32, 240);">'B'</span><span>, </span><span style="color: rgb(160, 32, 240);">'D'</span><span>, </span><span style="color: rgb(160, 32, 240);">'F'</span><span>, </span><span style="color: rgb(160, 32, 240);">'G'</span><span>}})];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span class="nonlocalVariableHighlighting">adj</span><span> = [</span><span class="nonlocalVariableHighlighting">adj</span><span>, struct(</span><span style="color: rgb(160, 32, 240);">'from'</span><span>, </span><span style="color: rgb(160, 32, 240);">'D'</span><span>, </span><span style="color: rgb(160, 32, 240);">'to'</span><span>, {{</span><span style="color: rgb(160, 32, 240);">'C'</span><span>, </span><span style="color: rgb(160, 32, 240);">'G'</span><span>}})];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span class="nonlocalVariableHighlighting">adj</span><span> = [</span><span class="nonlocalVariableHighlighting">adj</span><span>, struct(</span><span style="color: rgb(160, 32, 240);">'from'</span><span>, </span><span style="color: rgb(160, 32, 240);">'E'</span><span>, </span><span style="color: rgb(160, 32, 240);">'to'</span><span>, {{</span><span style="color: rgb(160, 32, 240);">'A'</span><span>, </span><span style="color: rgb(160, 32, 240);">'B'</span><span>, </span><span style="color: rgb(160, 32, 240);">'F'</span><span>}})];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span class="nonlocalVariableHighlighting">adj</span><span> = [</span><span class="nonlocalVariableHighlighting">adj</span><span>, struct(</span><span style="color: rgb(160, 32, 240);">'from'</span><span>, </span><span style="color: rgb(160, 32, 240);">'F'</span><span>, </span><span style="color: rgb(160, 32, 240);">'to'</span><span>, {{</span><span style="color: rgb(160, 32, 240);">'B'</span><span>, </span><span style="color: rgb(160, 32, 240);">'C'</span><span>, </span><span style="color: rgb(160, 32, 240);">'E'</span><span>, </span><span style="color: rgb(160, 32, 240);">'G'</span><span>}})];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span class="nonlocalVariableHighlighting">adj</span><span> = [</span><span class="nonlocalVariableHighlighting">adj</span><span>, struct(</span><span style="color: rgb(160, 32, 240);">'from'</span><span>, </span><span style="color: rgb(160, 32, 240);">'G'</span><span>, </span><span style="color: rgb(160, 32, 240);">'to'</span><span>, {{</span><span style="color: rgb(160, 32, 240);">'C'</span><span>, </span><span style="color: rgb(160, 32, 240);">'D'</span><span>, </span><span style="color: rgb(160, 32, 240);">'F'</span><span>}})];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">% Don't worry about exactly why this algorithm works</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">% It is actually a search for "strongly connected components" (SCC's)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">% described in the Corman, Leiserson, Rivest text</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">% "Introduction to Algorithms" pp 488-493</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">% this is the algorithm:</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">% 1. compute u, a Depth First Search (DFS: Para 7.4.2), storing the</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">%    finish order f(u)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">% 2. compute a DFS using f(u) in descending order finish times d(u)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">% 3. compute fi(u), the forefather of each node in u defined as that</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">%    node w connected to u with the maximum value of f(w). Note: to</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">%    get this right, u can connect to itself</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">% 4. all the nodes in u with the same forefather form one of the</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">%    groups of SCC's </span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">% 5. select the beams for each group that connect the group's </span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">%    forefather to all the other nodes. </span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">%</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">% so here we go</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">%    set all nodes to 'not used' except A</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    at = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    finish = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    N = length(</span><span class="nonlocalVariableHighlighting">adj</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">for </span><span>ndx = 1:N</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        </span><span class="nonlocalVariableHighlighting">adj</span><span>(ndx).used = false;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">% construct a list of beams</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span class="nonlocalVariableHighlighting">beams</span><span> = [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">for </span><span>ndx = 1:length(</span><span class="nonlocalVariableHighlighting">adj</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        fr = </span><span class="nonlocalVariableHighlighting">adj</span><span>(ndx).from;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        ca = </span><span class="nonlocalVariableHighlighting">adj</span><span>(ndx).to;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        </span><span style="color: rgb(0, 0, 255);">for </span><span>c = ca</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>            bm = [fr c{1}];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>            </span><span style="color: rgb(0, 0, 255);">if </span><span>~is_beam(bm)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>               </span><span class="nonlocalVariableHighlighting">beams</span><span> = [</span><span class="nonlocalVariableHighlighting">beams</span><span> {bm}]; </span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>            </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span class="nonlocalVariableHighlighting">adj</span><span>(1).used = true;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span class="nonlocalVariableHighlighting">adj</span><span>(1).f = finish;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    u(1) = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    nxt = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">% fprintf('u(%d) = %c; f(%d) = %d\n', 1, adj(1).from, 1, adj(1).f); </span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">% 1. DFS starting at A, choosing the first child reachable from </span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">%    the current node u storing the finish time f(u)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">for </span><span>ndx = 2:N</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        nxt = get_DFS_next(nxt);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        finish = finish + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        </span><span class="nonlocalVariableHighlighting">adj</span><span>(nxt).used = true;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        u(nxt) = nxt;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        </span><span class="nonlocalVariableHighlighting">adj</span><span>(nxt).f = finish;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">%     fprintf('u(%d) = %c; f(%d) = %d\n', ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">%         ndx, adj(nxt).from, ndx, adj(nxt).f); </span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">% 2. compute a DFS using f(u) in descending order finish times d(u)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    f_vals = [</span><span class="nonlocalVariableHighlighting">adj</span><span>.f];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    finish = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">for </span><span>ndx = 1:N</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        at = find(f_vals == (7 - ndx));</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        v(ndx) = at;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        </span><span class="nonlocalVariableHighlighting">adj</span><span>(at).d = finish;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        finish = finish + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">%     fprintf('v(%d) = %c; d(%d) = %d\n', ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">%         ndx, adj(at).from, ndx, adj(at).d); </span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">% 3. compute fi(u), the forefather of each node in u defined as that</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">%    node w connected to u with the maximum value of f(w). Note: to</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">%    get this right, u can connect to itself</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">for </span><span>ndx = 1:N</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        ca = [{</span><span class="nonlocalVariableHighlighting">adj</span><span>(ndx).from, </span><span class="nonlocalVariableHighlighting">adj</span><span>(ndx).to{:}}];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        it = [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        ord = [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        </span><span style="color: rgb(0, 0, 255);">for </span><span>c = ca</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>            jk = c{1} - </span><span style="color: rgb(160, 32, 240);">'A' </span><span>+ 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>            ord = [ord jk];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>            it = [it </span><span class="nonlocalVariableHighlighting">adj</span><span>(jk).f];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        [~, at] = max(it);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        choice = ca{at} - </span><span style="color: rgb(160, 32, 240);">'A' </span><span>+ 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        </span><span class="nonlocalVariableHighlighting">adj</span><span>(ndx).fi = choice;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    finx = [</span><span class="nonlocalVariableHighlighting">adj</span><span>.fi];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    fi = char(finx + </span><span style="color: rgb(160, 32, 240);">'A' </span><span>- 1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">% 4. all the nodes in u with the same forefather form one of the</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">%    groups of SCC's </span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    at = [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    ca = {</span><span class="nonlocalVariableHighlighting">adj</span><span>.from};</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    foref = [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">for </span><span>ndx = 1:7</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        </span><span style="color: rgb(0, 0, 255);">if </span><span>any(finx == ndx)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>            grp = ca(finx == ndx);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>            at = [at {grp}];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>            foref = [foref ndx];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">% 5. a. select the beams for each group that connect the group's </span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">%    forefather to all the other nodes. </span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">%    b. select the beams totally within the emerging collection</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">%    of nodes</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    save_bms = [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    all_nodes = [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">for </span><span>gndx = 1:length(at)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        ff = foref(gndx);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        ca = at{gndx};</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        all_nodes = [all_nodes ca];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        fprintf(</span><span style="color: rgb(160, 32, 240);">'group %d = {'</span><span>, gndx);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        </span><span style="color: rgb(0, 0, 255);">for </span><span>nx = 1:length(ca)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>            fprintf(</span><span style="color: rgb(160, 32, 240);">' %s'</span><span>, ca{nx});</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>            beam = [</span><span class="nonlocalVariableHighlighting">adj</span><span>(ff).from, ca{nx}];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>            save_bms = add_beam(save_bms, beam);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        fprintf(</span><span style="color: rgb(160, 32, 240);">' }\n'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">% also save all beams with both ends in all_nodes</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        </span><span style="color: rgb(0, 0, 255);">for </span><span>nx = 1:length(all_nodes)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>            </span><span style="color: rgb(0, 0, 255);">for </span><span>ny = nx+1:length(all_nodes)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>               bm = [all_nodes{nx} all_nodes{ny}];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>               save_bms = add_beam(save_bms, bm);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>            </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(60, 118, 61);">% display the answers</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    fprintf(</span><span style="color: rgb(160, 32, 240);">'Beams should arrive in this order:\n'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">for </span><span>bm = save_bms</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        b = bm{:};</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        fprintf(</span><span style="color: rgb(160, 32, 240);">'%c-%c '</span><span>, b(1), b(2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    fprintf(</span><span style="color: rgb(160, 32, 240);">'\n'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: normal;"><span style="color: rgb(0, 0, 255);">function </span><span>bms = add_beam(bms, beam)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">if </span><span>is_beam(beam)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        </span><span style="color: rgb(60, 118, 61);">% check if it's already there</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        rev = [beam(2) beam(1)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        </span><span style="color: rgb(0, 0, 255);">if </span><span>~(any(strcmp(bms, beam))||any(strcmp(bms, rev)))</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>            bms = [bms {beam}];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span style="color: rgb(0, 0, 255);">function </span><span>is = is_beam(str)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">global </span><span class="nonlocalVariableHighlighting">beams</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    is = false;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    rev = [str(2) str(1)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">for </span><span>ndx = 1:length(</span><span class="nonlocalVariableHighlighting">beams</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        </span><span style="color: rgb(0, 0, 255);">if </span><span>strcmp(</span><span class="nonlocalVariableHighlighting">beams</span><span>{ndx}, str) || strcmp(</span><span class="nonlocalVariableHighlighting">beams</span><span>{ndx},rev)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>            is = true;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>            </span><span style="color: rgb(0, 0, 255);">break</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span style="color: rgb(0, 0, 255);">function </span><span>res = get_DFS_next(u)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">global </span><span class="nonlocalVariableHighlighting">adj</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    ca = </span><span class="nonlocalVariableHighlighting">adj</span><span>(u).to;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    to_ndx = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    at = ca{to_ndx} - </span><span style="color: rgb(160, 32, 240);">'A' </span><span>+ 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">while </span><span class="nonlocalVariableHighlighting">adj</span><span>(at).used</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        to_ndx = to_ndx + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>        at = ca{to_ndx} - </span><span style="color: rgb(160, 32, 240);">'A' </span><span>+ 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>    res = at;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: normal;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
function main
% Listing 7.6: Connectivity of a structure
    global adj
    global beams
    % describe the structure as an adjacency list identifying for each
    % node 'A'-'G' the notes to which it directly connects
    adj = [];
    adj = [adj, struct('from', 'A', 'to', {{'B', 'E'}})];
    adj = [adj, struct('from', 'B', 'to', {{'A', 'C', 'E', 'F'}})];
    adj = [adj, struct('from', 'C', 'to', {{'B', 'D', 'F', 'G'}})];
    adj = [adj, struct('from', 'D', 'to', {{'C', 'G'}})];
    adj = [adj, struct('from', 'E', 'to', {{'A', 'B', 'F'}})];
    adj = [adj, struct('from', 'F', 'to', {{'B', 'C', 'E', 'G'}})];
    adj = [adj, struct('from', 'G', 'to', {{'C', 'D', 'F'}})];
    % Don't worry about exactly why this algorithm works
    % It is actually a search for "strongly connected components" (SCC's)
    % described in the Corman, Leiserson, Rivest text
    % "Introduction to Algorithms" pp 488-493
    % this is the algorithm:
    % 1. compute u, a Depth First Search (DFS: Para 7.4.2), storing the
    %    finish order f(u)
    % 2. compute a DFS using f(u) in descending order finish times d(u)
    % 3. compute fi(u), the forefather of each node in u defined as that
    %    node w connected to u with the maximum value of f(w). Note: to
    %    get this right, u can connect to itself
    % 4. all the nodes in u with the same forefather form one of the
    %    groups of SCC's 
    % 5. select the beams for each group that connect the group's 
    %    forefather to all the other nodes. 
    %
    % so here we go
    %    set all nodes to 'not used' except A
    at = 1;
    finish = 0;
    N = length(adj);
    for ndx = 1:N
        adj(ndx).used = false;
    end
    % construct a list of beams
    beams = [];
    for ndx = 1:length(adj)
        fr = adj(ndx).from;
        ca = adj(ndx).to;
        for c = ca
            bm = [fr c{1}];
            if ~is_beam(bm)
               beams = [beams {bm}]; 
            end
        end
    end
    adj(1).used = true;
    adj(1).f = finish;
    u(1) = 1;
    nxt = 1;
    % fprintf('u(%d) = %c; f(%d) = %d\n', 1, adj(1).from, 1, adj(1).f); 
    % 1. DFS starting at A, choosing the first child reachable from 
    %    the current node u storing the finish time f(u)
    for ndx = 2:N
        nxt = get_DFS_next(nxt);
        finish = finish + 1;
        adj(nxt).used = true;
        u(nxt) = nxt;
        adj(nxt).f = finish;
    %     fprintf('u(%d) = %c; f(%d) = %d\n', ...
    %         ndx, adj(nxt).from, ndx, adj(nxt).f); 
    end
    % 2. compute a DFS using f(u) in descending order finish times d(u)
    f_vals = [adj.f];
    finish = 0;
    for ndx = 1:N
        at = find(f_vals == (7 - ndx));
        v(ndx) = at;
        adj(at).d = finish;
        finish = finish + 1;
    %     fprintf('v(%d) = %c; d(%d) = %d\n', ...
    %         ndx, adj(at).from, ndx, adj(at).d); 
    end
    % 3. compute fi(u), the forefather of each node in u defined as that
    %    node w connected to u with the maximum value of f(w). Note: to
    %    get this right, u can connect to itself
    for ndx = 1:N
        ca = [{adj(ndx).from, adj(ndx).to{:}}];
        it = [];
        ord = [];
        for c = ca
            jk = c{1} - 'A' + 1;
            ord = [ord jk];
            it = [it adj(jk).f];
        end
        [~, at] = max(it);
        choice = ca{at} - 'A' + 1;
        adj(ndx).fi = choice;
    end
    finx = [adj.fi];
    fi = char(finx + 'A' - 1);
    % 4. all the nodes in u with the same forefather form one of the
    %    groups of SCC's 
    at = [];
    ca = {adj.from};
    foref = [];
    for ndx = 1:7
        if any(finx == ndx)
            grp = ca(finx == ndx);
            at = [at {grp}];
            foref = [foref ndx];
        end
    end
    % 5. a. select the beams for each group that connect the group's 
    %    forefather to all the other nodes. 
    %    b. select the beams totally within the emerging collection
    %    of nodes
    save_bms = [];
    all_nodes = [];
    for gndx = 1:length(at)
        ff = foref(gndx);
        ca = at{gndx};
        all_nodes = [all_nodes ca];
        fprintf('group %d = {', gndx);
        for nx = 1:length(ca)
            fprintf(' %s', ca{nx});
            beam = [adj(ff).from, ca{nx}];
            save_bms = add_beam(save_bms, beam);
        end
        fprintf(' }\n');
    % also save all beams with both ends in all_nodes
        for nx = 1:length(all_nodes)
            for ny = nx+1:length(all_nodes)
               bm = [all_nodes{nx} all_nodes{ny}];
               save_bms = add_beam(save_bms, bm);
            end
        end
    end
    % display the answers
    fprintf('Beams should arrive in this order:\n');
    for bm = save_bms
        b = bm{:};
        fprintf('%c-%c ', b(1), b(2));
    end
    fprintf('\n');
end
%%
function bms = add_beam(bms, beam)
    if is_beam(beam)
        % check if it's already there
        rev = [beam(2) beam(1)];
        if ~(any(strcmp(bms, beam))||any(strcmp(bms, rev)))
            bms = [bms {beam}];
        end
    end
end
function is = is_beam(str)
    global beams
    is = false;
    rev = [str(2) str(1)];
    for ndx = 1:length(beams)
        if strcmp(beams{ndx}, str) || strcmp(beams{ndx},rev)
            is = true;
            break;
        end
    end
end
function res = get_DFS_next(u)
    global adj;
    ca = adj(u).to;
    to_ndx = 1;
    at = ca{to_ndx} - 'A' + 1;
    while adj(at).used
        to_ndx = to_ndx + 1;
        at = ca{to_ndx} - 'A' + 1;
    end
    res = at;
end
##### SOURCE END #####
--></body></html>