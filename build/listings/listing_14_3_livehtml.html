<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB R2020a"><title>Untitled</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: normal; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S1 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: normal; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S2 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: normal; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S3 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: normal; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h3  class = 'S0'><span>Listing 14.3</span></h3><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: normal;"><span style="color: rgb(60, 118, 61);">% Set up the time domain signal</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>dt = 1/400 </span><span style="color: rgb(60, 118, 61);">% sampling period (sec)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>pts = 10000 </span><span style="color: rgb(60, 118, 61);">% number of points</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>f = 8 </span><span style="color: rgb(60, 118, 61);">% frequency</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>t = (1:pts) * dt; </span><span style="color: rgb(60, 118, 61);">% time array for plotting</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>x = sin(2*pi*f*t);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span style="color: rgb(60, 118, 61);">% Plot the front part of the time trace</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>subplot(3, 1, 1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>plot(t(1:end/25), x(1:end/25));</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>title( </span><span style="color: rgb(160, 32, 240);">'Time Domain Sine Wave' </span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>ylabel( </span><span style="color: rgb(160, 32, 240);">'Amplitude' </span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>xlabel( </span><span style="color: rgb(160, 32, 240);">'Time (Sec)' </span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>Y = fft(x); </span><span style="color: rgb(60, 118, 61);">% perform the transform</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span style="color: rgb(60, 118, 61);">% Set up the frequency plots</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>df = 1 / t(end) </span><span style="color: rgb(60, 118, 61);">% the frequency interval</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>fmax = df * pts / 2</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>f = (1:pts) * 2 * fmax / pts;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span style="color: rgb(60, 118, 61);">% frequencies for plotting</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span style="color: rgb(60, 118, 61);">% Plot the spectrum real part.</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>subplot(3, 1, 2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>plot(f, real(Y))</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>title( </span><span style="color: rgb(160, 32, 240);">'Real Part' </span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>xlabel( </span><span style="color: rgb(160, 32, 240);">'Frequency (Hz)' </span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>ylabel( </span><span style="color: rgb(160, 32, 240);">'Energy' </span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span style="color: rgb(60, 118, 61);">% Plot the spectrum imaginary part.</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>subplot(3, 1, 3)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>plot(f, imag(Y))</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>title( </span><span style="color: rgb(160, 32, 240);">'Imaginary Part' </span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: normal;"><span>xlabel( </span><span style="color: rgb(160, 32, 240);">'Frequency (Hz)' </span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: normal;"><span>ylabel( </span><span style="color: rgb(160, 32, 240);">'Energy' </span><span>)</span></span></div></div></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
% Listing 14.3

% Set up the time domain signal
dt = 1/400 % sampling period (sec)
pts = 10000 % number of points
f = 8 % frequency
t = (1:pts) * dt; % time array for plotting
x = sin(2*pi*f*t);

% Plot the front part of the time trace
subplot(3, 1, 1)
plot(t(1:end/25), x(1:end/25));
title( 'Time Domain Sine Wave' )
ylabel( 'Amplitude' )
xlabel( 'Time (Sec)' )

Y = fft(x); % perform the transform

% Set up the frequency plots
df = 1 / t(end) % the frequency interval
fmax = df * pts / 2
f = (1:pts) * 2 * fmax / pts;
% frequencies for plotting

% Plot the spectrum real part.
subplot(3, 1, 2)
plot(f, real(Y))
title( 'Real Part' )
xlabel( 'Frequency (Hz)' )
ylabel( 'Energy' )

% Plot the spectrum imaginary part.
subplot(3, 1, 3)
plot(f, imag(Y))
title( 'Imaginary Part' )
xlabel( 'Frequency (Hz)' )
ylabel( 'Energy' )
##### SOURCE END #####
--></body></html>