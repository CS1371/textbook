<code><strong>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">% Synthesizing a piano</font><br>
<font color="#0000ff">function</font> main<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">global</font> N<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">global</font> note<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">global</font> Fs<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">global</font> tempo<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">global</font> song<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">global</font> total_time<br>
&nbsp;&nbsp;&nbsp;&nbsp;Fs = <font color="#ff8000">44100</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;note = synthetic_piano;<br>
&nbsp;&nbsp;&nbsp;&nbsp;N = length(note);<br>
&nbsp;&nbsp;&nbsp;&nbsp;halfStep = <font color="#ff8000">2</font> .^ (<font color="#ff8000">1</font>/<font color="#ff8000">12</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;treble = {<font color="#c000c0">'G4'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'A4'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'G4'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'A4'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'B4'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'D5'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'E5'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'D5'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">%</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'G5'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'FS5'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'A5'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'G5'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'FS5'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'A5'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'G5'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'E5'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">%</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'D5'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'D5'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'E5'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'D5'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'G5'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'E5'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'D5'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'B4'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">%</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'A4'</font> <font color="#ff8000">16</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">%</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'G4'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'A4'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'G4'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'A4'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'B4'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'D5'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'E5'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'D5'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">%</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'G5'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'FS5'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'A5'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'G5'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'FS5'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'A5'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'G5'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'E5'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">%</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'D5'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'D5'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'G5'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'G4'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'A4'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'D5'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">%</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'G4'</font> <font color="#ff8000">16</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;};<br>
&nbsp;&nbsp;&nbsp;&nbsp;bass = { <font color="#c000c0">'G2'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'B2'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'G3'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'B3'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">%</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'C3'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'E3'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'G3'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'C4'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">%</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'G2'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'B2'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'G3'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'B3'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">%</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'D3'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'G3'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'FS3'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'E3'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">%</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'G2'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'B2'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'G3'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'B3'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">%</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'C3'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'E3'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'G3'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'C4'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">%</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'B2'</font> <font color="#ff8000">4</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'E3'</font> <font color="#ff8000">2</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'EF3'</font> <font color="#ff8000">2</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'D3'</font> <font color="#ff8000">8</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">%</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'G2'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'D3'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'B3'</font> <font color="#ff8000">3</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'D3'</font> <font color="#ff8000">1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c000c0">'G2'</font> <font color="#ff8000">4</font> };<br>
&nbsp;&nbsp;&nbsp;&nbsp;tempo = <font color="#ff8000">500</font> / <font color="#ff8000">60</font>;  <font color="#00A000">% number of beats in a second</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;beats = <font color="#ff8000">0</font>;         <font color="#00A000">% total beats</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">for</font> ndx = <font color="#ff8000">1</font>:length(treble)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beats = beats + treble{ndx,<font color="#ff8000">2</font>};<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">end</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;total_time = beats ./ tempo;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Nt = total_time .* Fs;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Nt = Nt + N + N;<br>
&nbsp;&nbsp;&nbsp;&nbsp;song = zeros(Nt,<font color="#ff8000">2</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;tic<br>
&nbsp;&nbsp;&nbsp;&nbsp;play_score(treble, <font color="#ff8000">1</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;play_score(bass, <font color="#ff8000">2</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;sound(song, Fs)<br>
&nbsp;&nbsp;&nbsp;&nbsp;pause(total_time)<br>
&nbsp;&nbsp;&nbsp;&nbsp;audiowrite(<font color="#c000c0">'humoresque_1.wav'</font>, song, Fs)<br>
&nbsp;&nbsp;&nbsp;&nbsp;fprintf(<font color="#c000c0">'playing time %0.3f\n'</font>, toc)<br>
<font color="#0000ff">end</font><br>
<font color="#0000ff">function</font> play_score(notes, col)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">global</font> N<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">global</font> note<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">global</font> Fs<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">global</font> tempo<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">global</font> total_time<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">global</font> song<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;at = <font color="#ff8000">1</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">for</font> ndx = <font color="#ff8000">1</font>:length(notes)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = notes{ndx, <font color="#ff8000">1</font>};<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dur = notes{ndx, <font color="#ff8000">2</font>};<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">%   translate 'G4' to nt</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[mult, muted] = getPitch(name);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">%    - number of half steps above middle C</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">%     mult = halfStep .^ nt;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sampler = floor(linspace(<font color="#ff8000">1</font>, N, N / mult));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;play = note(sampler);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">%         sound(play, Fs)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">%       copy play at at</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">if</font> at + length(play) > length(song)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;play = play(<font color="#ff8000">1</font>:(length(song) - at - <font color="#ff8000">1</font>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">end</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">% limit length of note to note duration</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nn = round(Fs .* dur ./ tempo);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">if</font> length(play) > nn<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;play = play(<font color="#ff8000">1</font>:nn);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">end</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">try</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;song(at : (at + length(play) - <font color="#ff8000">1</font>), col) = <font color="#ff8000">...</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;song(at : (at + length(play) - <font color="#ff8000">1</font>), col) + play;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">catch</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ouch = true;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">end</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;at = at + nn;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">end</font><br>
<font color="#0000ff">end</font><br>
<font color="#0000ff">function</font> note = synthetic_piano<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">global</font> Fs<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">% create a piano note playing middle C</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;coeff =[ -<font color="#ff8000">2.7871</font> <font color="#ff8000">2.8145</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;-<font color="#ff8000">3.1836</font> <font color="#ff8000">0.2835</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;-<font color="#ff8000">0.7267</font> <font color="#ff8000">1.2517</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;-<font color="#ff8000">0.4538</font> <font color="#ff8000">0.4381</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;-<font color="#ff8000">0.7132</font> <font color="#ff8000">0.2829</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff8000">0.6205</font> <font color="#ff8000">0.2548</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;-<font color="#ff8000">0.5155</font> <font color="#ff8000">0.4718</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff8000">0.2322</font> <font color="#ff8000">0.3237</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff8000">0.1586</font> <font color="#ff8000">0.1278</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;-<font color="#ff8000">0.1321</font> <font color="#ff8000">0.0467</font>]<br>
&nbsp;&nbsp;&nbsp;&nbsp;coeff = coeff .* <font color="#ff8000">1000</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;shape = [   <font color="#ff8000">1.102058e</font>-<font color="#ff8000">37</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;-<font color="#ff8000">4.114411e</font>-<font color="#ff8000">32</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff8000">6.294645e</font>-<font color="#ff8000">27</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;-<font color="#ff8000">5.028251e</font>-<font color="#ff8000">22</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff8000">2.195125e</font>-<font color="#ff8000">17</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;-<font color="#ff8000">4.919492e</font>-<font color="#ff8000">13</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff8000">4.704579e</font>-<font color="#ff8000">09</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;-<font color="#ff8000">3.395830e</font>-<font color="#ff8000">05</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff8000">9.247657e</font>-<font color="#ff8000">01</font> ];<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;duration = <font color="#ff8000">2</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;note = zeros(<font color="#ff8000">1</font>, Fs * duration);<br>
&nbsp;&nbsp;&nbsp;&nbsp;frq = <font color="#ff8000">261</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;t = linspace(<font color="#ff8000">0</font>, duration, Fs * duration);<br>
&nbsp;&nbsp;&nbsp;&nbsp;totalLength = Fs * duration;<br>
&nbsp;&nbsp;&nbsp;&nbsp;w = <font color="#ff8000">2</font> * pi * frq;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">for</font> ndx = <font color="#ff8000">1</font>:length(coeff)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;note = note + coeff(ndx, <font color="#ff8000">1</font>) .* cos(ndx * w * t);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;note = note + coeff(ndx, <font color="#ff8000">2</font>) .* sin(ndx * w * t);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">end</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">% scale it to +/- 1</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;amp = max(abs(note));<br>
&nbsp;&nbsp;&nbsp;&nbsp;note = note / amp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;ampmod = polyval(shape, <font color="#ff8000">1</font>:totalLength);<br>
&nbsp;&nbsp;&nbsp;&nbsp;note = note .* ampmod;<br>
&nbsp;&nbsp;&nbsp;&nbsp;note = note';<br>
&nbsp;&nbsp;&nbsp;&nbsp;sound(note, Fs)<br>
&nbsp;&nbsp;&nbsp;&nbsp;pause(length(note)./Fs)<br>
<font color="#0000ff">end</font><br>
<font color="#0000ff">function</font> [pitch, muted] = getPitch(note)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00A000">% Get the pitch of a note in ascii form</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;half = <font color="#ff8000">2</font>.^(<font color="#ff8000">1</font>/<font color="#ff8000">12</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;muted = false;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">switch</font> note(<font color="#ff8000">1</font>:end-<font color="#ff8000">1</font>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">case</font> {<font color="#c000c0">'C'</font>}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;power = <font color="#ff8000">0</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">case</font> {<font color="#c000c0">'R'</font>}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;power = <font color="#ff8000">0</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;muted = true;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">case</font> {<font color="#c000c0">'CS'</font> 'DF'}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;power = <font color="#ff8000">1</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">case</font> <font color="#c000c0">'D'</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;power = <font color="#ff8000">2</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">case</font> {<font color="#c000c0">'DS'</font> 'EF'}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;power = <font color="#ff8000">3</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">case</font> <font color="#c000c0">'E'</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;power = <font color="#ff8000">4</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">case</font> <font color="#c000c0">'F'</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;power = <font color="#ff8000">5</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">case</font> {<font color="#c000c0">'FS'</font> 'GF'}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;power = <font color="#ff8000">6</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">case</font> <font color="#c000c0">'G'</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;power = <font color="#ff8000">7</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">case</font> {<font color="#c000c0">'GS'</font> 'AF'}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;power = <font color="#ff8000">8</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">case</font> <font color="#c000c0">'A'</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;power = <font color="#ff8000">9</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">case</font> {<font color="#c000c0">'AS'</font> 'BF'}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;power = <font color="#ff8000">10</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">case</font> <font color="#c000c0">'B'</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;power = <font color="#ff8000">11</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">otherwise</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error([<font color="#c000c0">'bad note value: '</font> note])<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">end</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let = note(end) - <font color="#c000c0">'0'</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diff = let - <font color="#ff8000">4</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;power = power + <font color="#ff8000">12</font> * diff;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pitch = half .^ power;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">end</font><br>
</strong></code>
